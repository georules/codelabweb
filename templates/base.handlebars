<!DOCTYPE html>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link href="bootstrap.css" rel="stylesheet">
<link href="bootstrap-responsive.css" rel="stylesheet">
<script src="jquery-2.0.2.min.js" type="text/javascript"></script>
<style>
html,body {
	height: 100%;
	min-height: 100%;
}
.fill {
	height:95%;
	min-height:95%;
}
#dragbar{
   background-color:black;
   height:100%;
   float: right;
   width: 10px;
   cursor: col-resize;
}
iframe {
	border: 0; padding:0; margin: 0;
}
textarea {
	width:100%; margin:0; padding:0; border-width:0;
	height:85%;
}
#htmlpanel,#csspanel {
	border: 1px solid black;
	height:49%;
	margin-bottom:2px;
}
#coding {
	margin-left:0px;
}
.container-fluid {
	padding:0;
}
.header {
	height:50px;
	border-bottom:10px solid black;
	padding-left:10px;
}
.tarp {
	/*background-color:rgba(128,128,128,0.5);*/
	width:100%;
	height:100%;
	position: absolute;
	top:0;
	left:0;
}
</style>

<script>
function refresh()	{
	var html = $("#htmlcode").val();
	var css = "<style type=\"text/css\">" + $("#csscode").val() + "</style>";
	$("#showpage").contents().find('head').html(css);
	$("#showpage").contents().find('body').html(html);
}
function resize()	{
	var h = $(window).height() - $('.header').height()-12;
	$(".fill").height(h);
	var w = $("#show").width();
	$("#showpage").css('width',w-15);
}
$(document).ready(function() {
	resize();	
	refresh();
	$('#htmlcode').keyup(refresh);
	$('#csscode').keyup(refresh);

	$(window).resize(resize);

	$('#dragbar').mousedown(function(e){
        e.preventDefault();
				$("body").append('<div class="tarp"></div>')
        $(document).mousemove(function(e){
				if (e.pageX > 100)	{
          $('#show').css("width",e.pageX);
					resize();
          $('#coding').css("left",e.pageX+2);
					$('#coding').children().css("left",e.pageX+2);
					}
       })
       console.log("leaving mouseDown");
    });
   $(document).mouseup(function(e){
			$('.tarp').remove();
       $(document).unbind('mousemove');
       });
});
</script>

</head>
<body>

<div class="container-fluid fill">
	<div class="row-fluid">
		<div class="header span12">
			<h4 class="pull-left">Code Lab Web: {{id}}</h4>
			<form class="pull-right" action="/{{id}}" method="post"><input type="submit" value="Save"></form>
		</div>
	</div>
	<div class="main row-fluid fill">
		<div id="show" class="span8 fill">
			<iframe id="showpage" class="fill"></iframe>
			<div id="dragbar"></div>
		</div>
		<div id="coding" class="span4 fill">
			<div id="htmlpanel">
				<h5>HTML</h5>
				<textarea id="htmlcode" width="100%">{{htmlcode}}</textarea>
			</div>
			<div id="csspanel">
				<h5>CSS</h5>
				<textarea id="csscode" width="100%">{{csscode}}</textarea>
			</div>
		</div>
	</div>
</div>

</body>
</html>
